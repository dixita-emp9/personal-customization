import{j as e}from"./jsx-runtime-CfvKYIdH.js";import{J as a,n as g}from"./index-Fo_aFtOQ.js";import{L as C,r as m,f as I}from"./chunk-TMI4QPZX-JoEkPh98.js";import{u as y,P as N}from"./ProductPrice-DYmdCbW_.js";import{u as A}from"./variants-C37mBJ9p.js";import{I as U}from"./Image-CZJc8TUH.js";import{M as b}from"./Money-C0o62AKO.js";function R({layout:t,line:s}){var u;const{id:n,merchandise:i}=s,{product:r,title:d,image:o,selectedOptions:l}=i,h=A(r.handle,l),{close:x}=y();return e.jsxs("li",{className:"cart-line",children:[o&&e.jsx(U,{alt:d,aspectRatio:"1/1",data:o,height:100,loading:"lazy",width:100}),e.jsxs("div",{children:[e.jsx(C,{prefetch:"intent",to:h,onClick:()=>{t==="aside"&&x()},children:e.jsx("p",{children:e.jsx("strong",{children:r.title})})}),e.jsx(N,{price:(u=s==null?void 0:s.cost)==null?void 0:u.totalAmount}),e.jsx("ul",{children:l.map(c=>e.jsx("li",{children:e.jsxs("small",{children:[c.name,": ",c.value]})},c.name))}),e.jsx(L,{line:s})]})]},n)}function L({line:t}){if(!t||typeof(t==null?void 0:t.quantity)>"u")return null;const{id:s,quantity:n,isOptimistic:i}=t,r=Number(Math.max(0,n-1).toFixed(0)),d=Number((n+1).toFixed(0));return e.jsxs("div",{className:"cart-line-quantity",children:[e.jsxs("small",{children:["Quantity: ",n,"   "]}),e.jsx(p,{lines:[{id:s,quantity:r}],children:e.jsx("button",{"aria-label":"Decrease quantity",disabled:n<=1||!!i,name:"decrease-quantity",value:r,children:e.jsx("span",{children:"− "})})})," ",e.jsx(p,{lines:[{id:s,quantity:d}],children:e.jsx("button",{"aria-label":"Increase quantity",name:"increase-quantity",value:d,disabled:!!i,children:e.jsx("span",{children:"+"})})})," ",e.jsx(k,{lineIds:[s],disabled:!!i})]})}function k({lineIds:t,disabled:s}){return e.jsx(a,{fetcherKey:v(t),route:"/cart",action:a.ACTIONS.LinesRemove,inputs:{lineIds:t},children:e.jsx("button",{disabled:s,type:"submit",children:"Remove"})})}function p({children:t,lines:s}){const n=s.map(i=>i.id);return e.jsx(a,{fetcherKey:v(n),route:"/cart",action:a.ACTIONS.LinesUpdate,inputs:{lines:s},children:t})}function v(t){return[a.ACTIONS.LinesUpdate,...t].join("-")}function q({cart:t,layout:s}){var i,r,d;const n=s==="page"?"cart-summary-page":"cart-summary-aside";return e.jsxs("div",{"aria-labelledby":"cart-summary",className:n,children:[e.jsx("h4",{children:"Totals"}),e.jsxs("dl",{className:"cart-subtotal",children:[e.jsx("dt",{children:"Subtotal"}),e.jsx("dd",{children:(r=(i=t==null?void 0:t.cost)==null?void 0:i.subtotalAmount)!=null&&r.amount?e.jsx(b,{data:(d=t==null?void 0:t.cost)==null?void 0:d.subtotalAmount}):"-"})]}),e.jsx(G,{discountCodes:t==null?void 0:t.discountCodes}),e.jsx(O,{giftCardCodes:t==null?void 0:t.appliedGiftCards}),e.jsx(D,{checkoutUrl:t==null?void 0:t.checkoutUrl})]})}function D({checkoutUrl:t}){return t?e.jsxs("div",{children:[e.jsx("a",{href:t,target:"_self",children:e.jsx("p",{children:"Continue to Checkout →"})}),e.jsx("br",{})]}):null}function G({discountCodes:t}){var n;const s=((n=t==null?void 0:t.filter(i=>i.applicable))==null?void 0:n.map(({code:i})=>i))||[];return e.jsxs("div",{children:[e.jsx("dl",{hidden:!s.length,children:e.jsxs("div",{children:[e.jsx("dt",{children:"Discount(s)"}),e.jsx(f,{children:e.jsxs("div",{className:"cart-discount",children:[e.jsx("code",{children:s==null?void 0:s.join(", ")})," ",e.jsx("button",{children:"Remove"})]})})]})}),e.jsx(f,{discountCodes:s,children:e.jsxs("div",{children:[e.jsx("input",{type:"text",name:"discountCode",placeholder:"Discount code"})," ",e.jsx("button",{type:"submit",children:"Apply"})]})})]})}function f({discountCodes:t,children:s}){return e.jsx(a,{route:"/cart",action:a.ACTIONS.DiscountCodesUpdate,inputs:{discountCodes:t||[]},children:s})}function O({giftCardCodes:t}){const s=m.useRef([]),n=m.useRef(null),i=I({key:"gift-card-add"});m.useEffect(()=>{i.data&&(n.current.value="")},[i.data]);function r(d){const o=d.replace(/\s/g,"");s.current.includes(o)||s.current.push(o)}return e.jsxs("div",{children:[t&&t.length>0&&e.jsxs("dl",{children:[e.jsx("dt",{children:"Applied Gift Card(s)"}),t.map(d=>e.jsx(F,{giftCardId:d.id,children:e.jsxs("div",{className:"cart-discount",children:[e.jsxs("code",{children:["***",d.lastCharacters]})," ",e.jsx(b,{data:d.amountUsed})," ",e.jsx("button",{type:"submit",children:"Remove"})]})},d.id))]}),e.jsx(S,{giftCardCodes:s.current,saveAppliedCode:r,fetcherKey:"gift-card-add",children:e.jsxs("div",{children:[e.jsx("input",{type:"text",name:"giftCardCode",placeholder:"Gift card code",ref:n})," ",e.jsx("button",{type:"submit",disabled:i.state!=="idle",children:"Apply"})]})})]})}function S({giftCardCodes:t,saveAppliedCode:s,fetcherKey:n,children:i}){return e.jsx(a,{fetcherKey:n,route:"/cart",action:a.ACTIONS.GiftCardCodesUpdate,inputs:{giftCardCodes:t||[]},children:r=>{var o;const d=(o=r.formData)==null?void 0:o.get("giftCardCode");return d&&s&&s(d),i}})}function F({giftCardId:t,children:s}){return e.jsx(a,{route:"/cart",action:a.ACTIONS.GiftCardCodesRemove,inputs:{giftCardCodes:[t]},children:s})}function z({layout:t,cart:s}){var l,h,x,u,c;const n=g(s),i=!!((h=(l=n==null?void 0:n.lines)==null?void 0:l.nodes)!=null&&h.length),d=`cart-main ${n&&!!((u=(x=n==null?void 0:n.discountCodes)==null?void 0:x.filter(j=>j.applicable))!=null&&u.length)?"with-discount":""}`,o=n!=null&&n.totalQuantity?n.totalQuantity>0:!1;return e.jsxs("div",{className:d,children:[e.jsx(T,{hidden:i,layout:t}),e.jsxs("div",{className:"cart-details",children:[e.jsx("div",{"aria-labelledby":"cart-lines",children:e.jsx("ul",{children:(((c=n==null?void 0:n.lines)==null?void 0:c.nodes)??[]).map(j=>e.jsx(R,{line:j,layout:t},j.id))})}),o&&e.jsx(q,{cart:n,layout:t})]})]})}function T({hidden:t=!1}){const{close:s}=y();return e.jsxs("div",{hidden:t,children:[e.jsx("br",{}),e.jsx("p",{children:"Looks like you haven’t added anything yet, let’s get you started!"}),e.jsx("br",{}),e.jsx(C,{to:"/collections",onClick:s,prefetch:"viewport",children:"Continue shopping →"})]})}export{z as C};
